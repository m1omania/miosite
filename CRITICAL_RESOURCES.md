# Критическая перегрузка ресурсов сервера

## Проблема
- **CPU: 100%** (1 ядро × 2000 МГц)
- **RAM: 97%** (1.94 ГБ из 2 ГБ)

Это объясняет ошибки 500/502 - сервер не может обработать запросы из-за нехватки ресурсов.

## Срочные меры

### 1. Добавить USE_SINGLE_PROCESS=true

На сервере выполните:

```bash
cd /opt/ux-audit/backend
nano .env
```

Добавьте строку:
```
USE_SINGLE_PROCESS=true
```

Затем перезапустите:
```bash
systemctl restart ux-audit-backend
```

**Примечание:** `--single-process` снизит нагрузку на CPU и память, но может быть медленнее.

### 2. Увеличить ресурсы сервера

В панели Jino.ru:
1. Нажмите "Настроить ресурсы" или "Увеличить"
2. Увеличьте RAM до **4GB** (минимум)
3. Увеличьте CPU до **2+ ядер** (рекомендуется)

### 3. Оптимизировать код

Уже сделано:
- ✅ Добавлены флаги для снижения потребления ресурсов
- ✅ Ограничение памяти до 512MB для Chrome
- ✅ Обработка закрытия браузера

Можно добавить:
- Закрывать браузер после каждого запроса (вместо переиспользования)
- Использовать более легкие настройки Puppeteer

## Проверка после исправления

1. Проверьте нагрузку CPU в панели Jino.ru - должна снизиться
2. Проверьте RAM - должна освободиться
3. Попробуйте проанализировать сайт снова

## Рекомендации

### Для VPS с 2GB RAM:
- **Обязательно** используйте `USE_SINGLE_PROCESS=true`
- Рассмотрите увеличение до 4GB RAM

### Для VPS с 4GB+ RAM:
- Текущие настройки должны работать
- Мониторьте нагрузку CPU

## Мониторинг

Следите за нагрузкой в панели Jino.ru:
- **Нормальная:** CPU 10-30%, RAM 50-70%
- **Высокая:** CPU 50-80%, RAM 70-90%
- **Критическая:** CPU 80%+, RAM 90%+ (нужно увеличить ресурсы)

## Текущий статус

- ❌ CPU: 100% (критическая нагрузка)
- ❌ RAM: 97% (критическая нагрузка)
- ⏳ Нужно добавить `USE_SINGLE_PROCESS=true`
- ⏳ Рассмотреть увеличение ресурсов сервера

